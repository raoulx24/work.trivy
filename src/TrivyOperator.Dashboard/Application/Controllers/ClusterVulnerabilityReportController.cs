using Microsoft.AspNetCore.Mvc;
using TrivyOperator.Dashboard.Application.Models;
using TrivyOperator.Dashboard.Application.Services.Abstractions;

namespace TrivyOperator.Dashboard.Application.Controllers;

[ApiController]
[Route("api/cluster-vulnerability-report")]
public class ClusterVulnerabilityReportController(
    IClusterVulnerabilityReportService ClusterVulnerabilityReportService) : ControllerBase
{
    [HttpGet(Name = "GetClusterVulnerabilityReportDtos")]
    [ProducesResponseType<IEnumerable<ClusterVulnerabilityReportDto>>(StatusCodes.Status200OK)]
    [ProducesResponseType<ProblemDetails>(StatusCodes.Status400BadRequest)]
    [ProducesResponseType<ProblemDetails>(StatusCodes.Status500InternalServerError)]
    public async Task<IEnumerable<ClusterVulnerabilityReportDto>> Get() =>
        await ClusterVulnerabilityReportService.GetClusterVulnerabilityReportDtos();

    [HttpGet("denormalized", Name = "GetClusterVulnerabilityReportDenormalizedDtos")]
    [ProducesResponseType<IEnumerable<ClusterVulnerabilityReportDenormalizedDto>>(StatusCodes.Status200OK)]
    [ProducesResponseType<ProblemDetails>(StatusCodes.Status400BadRequest)]
    [ProducesResponseType<ProblemDetails>(StatusCodes.Status500InternalServerError)]
    public async Task<IEnumerable<ClusterVulnerabilityReportDenormalizedDto>> GetDenormalized() =>
        await ClusterVulnerabilityReportService.GetClusterVulnerabilityReportDenormalizedDtos();
}
