using TrivyOperator.Dashboard.Application.Services.BackgroundQueues.Abstractions;
using TrivyOperator.Dashboard.Application.Services.CacheRefresh.Abstractions;
using TrivyOperator.Dashboard.Application.Services.CacheWatcherEventHandlers.Abstractions;
using TrivyOperator.Dashboard.Application.Services.WatcherEvents.Abstractions;
using TrivyOperator.Dashboard.Application.Services.Watchers.Abstractions;
using TrivyOperator.Dashboard.Domain.Trivy.ClusterVulnerabilityReport;
using TrivyOperator.Dashboard.Domain.Trivy.CustomResources.Abstractions;

namespace TrivyOperator.Dashboard.Application.Services.CacheWatcherEventHandlers;

public class ClusterVulnerabilityReportWatcherEventHandler(
    ICacheRefresh<ClusterVulnerabilityReportCr, IBackgroundQueue<ClusterVulnerabilityReportCr>> cacheRefresh,
    IClusterScopedWatcher<ClusterVulnerabilityReportCr> kubernetesWatcher,
    ILogger<ClusterVulnerabilityReportWatcherEventHandler> logger)
    : ClusterScopedCacheWatcherEventHandler<IBackgroundQueue<ClusterVulnerabilityReportCr>,
        ICacheRefresh<ClusterVulnerabilityReportCr, IBackgroundQueue<ClusterVulnerabilityReportCr>>,
        WatcherEvent<ClusterVulnerabilityReportCr>, IClusterScopedWatcher<ClusterVulnerabilityReportCr>,
        ClusterVulnerabilityReportCr, CustomResourceList<ClusterVulnerabilityReportCr>>(
        cacheRefresh,
        kubernetesWatcher,
        logger);
